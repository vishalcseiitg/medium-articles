<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>“Image Classification Basics with Python and TensorFlow: Building a CNN Model with CIFAR-10…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">“Image Classification Basics with Python and TensorFlow: Building a CNN Model with CIFAR-10…</h1>
</header>
<section data-field="subtitle" class="p-summary">
In the field of computer vision, image classification is one of the most fundamental tasks. It involves training a model to classify images…
</section>
<section data-field="body" class="e-content">
<section name="2296" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ee51" id="ee51" class="graf graf--h3 graf--startsWithDoubleQuote graf--leading graf--title">“Image Classification Basics with Python and TensorFlow: Building a CNN Model with CIFAR-10 Dataset”</h3><blockquote name="f728" id="f728" class="graf graf--pullquote graf-after--h3">In the field of computer vision, image classification is one of the most fundamental tasks. It involves training a model to classify images into different categories or classes based on their visual features. In this article, we will explore the basics of image classification and how to implement it in Python using the popular TensorFlow and Keras libraries.</blockquote><figure name="94de" id="94de" class="graf graf--figure graf-after--pullquote"><img class="graf-image" data-image-id="0*ODBS-QNceKW5AKzR" data-width="3024" data-height="4032" data-unsplash-photo-id="h5fsy4E4FMY" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*ODBS-QNceKW5AKzR"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@sallybrad2016?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@sallybrad2016?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Preethi Viswanathan</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="031b" id="031b" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--figure"><span class="graf-dropCap">I</span>mage classification involves analyzing the contents of an image and categorizing it into one of several predefined classes or categories. The goal is to train a model that can accurately classify new images it has never seen before. The process typically involves the following steps:</p><ol class="postList"><li name="5a65" id="5a65" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Collect and preprocess the data:</strong> The first step is to collect a dataset of images and preprocess them to prepare them for training the model. This involves resizing the images to a common size, converting them to grayscale or RGB format, and normalizing the pixel values to a range between 0 and 1.</li><li name="7e22" id="7e22" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Build a model:</strong> The next step is to build a model that can learn to classify the images. This typically involves using a deep learning architecture such as a convolutional neural network (CNN).</li><li name="90f2" id="90f2" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Train the model:</strong> Once the model is built, the next step is to train it on the dataset. This involves feeding the training images through the model and adjusting the model’s parameters to minimize the error between the predicted and true labels.</li><li name="b823" id="b823" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Evaluate the model:</strong> After the model is trained, the next step is to evaluate its performance on a separate test dataset. This involves measuring the accuracy of the model in predicting the correct labels for the test images.</li></ol><blockquote name="f9b3" id="f9b3" class="graf graf--pullquote graf-after--li">Building a CNN Model for Image Classification</blockquote><p name="8312" id="8312" class="graf graf--p graf-after--pullquote">We will use the CIFAR-10 dataset for this example, which consists of 60,000 32x32 color images in 10 classes. We will use TensorFlow and Keras to build a CNN model that can classify these images.</p><p name="7a09" id="7a09" class="graf graf--p graf-after--p">We can download the dataset using the following code:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="cpp" name="e5ab" id="e5ab" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">from tensorflow.keras.<span class="hljs-function">datasets <span class="hljs-keyword">import</span> <span class="hljs-title">cifar10</span><br /><br /><span class="hljs-params">(x_train, y_train)</span>, <span class="hljs-params">(x_test, y_test)</span> </span>= cifar10.<span class="hljs-built_in">load_data</span>()</span></pre><p name="c96a" id="c96a" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">x_train</code> and <code class="markup--code markup--p-code">y_train</code> variables contain the training images and their labels, respectively, while the <code class="markup--code markup--p-code">x_test</code> and <code class="markup--code markup--p-code">y_test</code> variables contain the test images and their labels, respectively.</p><p name="9a07" id="9a07" class="graf graf--p graf-after--p">Next, we can normalize the pixel values of the images by dividing each pixel value by 255.0. This will ensure that all pixel values are between 0 and 1.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="8f2c" id="8f2c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">x_train = x_train / <span class="hljs-number">255.0</span><br />x_test = x_test / <span class="hljs-number">255.0</span></span></pre><figure name="e4f8" id="e4f8" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*GxxP9PYBxD5uM0yRHnbZkg.jpeg" data-width="800" data-height="300" src="https://cdn-images-1.medium.com/max/800/1*GxxP9PYBxD5uM0yRHnbZkg.jpeg"><figcaption class="imageCaption">RGB representation of an <a href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" data-href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">image</a></figcaption></figure><p name="b422" id="b422" class="graf graf--p graf-after--figure">Finally, we can convert the labels into one-hot encoded vectors using the <code class="markup--code markup--p-code">to_categorical</code> function from the Keras library.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="c442" id="c442" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical<br /><br />y_train = to_categorical(y_train, num_classes=<span class="hljs-number">10</span>)<br />y_test = to_categorical(y_test, num_classes=<span class="hljs-number">10</span>)</span></pre><blockquote name="afbd" id="afbd" class="graf graf--pullquote graf-after--pre">Building the Model</blockquote><p name="40e6" id="40e6" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--pullquote"><span class="graf-dropCap">T</span>he next step is to build the model. We will use a simple convolutional neural network (CNN) with three convolutional layers followed by a fully connected layer and a softmax output layer.</p><figure name="8001" id="8001" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aREoCci4qO15QaWKjlpNPg.jpeg" data-width="1000" data-height="341" src="https://cdn-images-1.medium.com/max/800/1*aREoCci4qO15QaWKjlpNPg.jpeg"><figcaption class="imageCaption">The image is taken from the <a href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" data-href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">link</a></figcaption></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="csharp" name="e0a9" id="e0a9" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">from</span> tensorflow.keras.models import Sequential<br /><span class="hljs-keyword">from</span> tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense<br /><br />model = Sequential()<br /><br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>, input_shape=(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">3</span>)))<br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">32</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">64</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">128</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(Conv2D(<span class="hljs-number">128</span>, (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), activation=<span class="hljs-string">&#x27;relu&#x27;</span>, padding=<span class="hljs-string">&#x27;same&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(MaxPooling2D((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)))<br />model.<span class="hljs-keyword">add</span>(Flatten())<br />model.<span class="hljs-keyword">add</span>(Dense(<span class="hljs-number">128</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))<br />model.<span class="hljs-keyword">add</span>(Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">&#x27;softmax&#x27;</span>))<br /><br />model.summary()</span></pre><blockquote name="43d1" id="43d1" class="graf graf--pullquote graf-after--pre">Output:</blockquote><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="7eff" id="7eff" class="graf graf--pre graf-after--pullquote graf--preV2"><span class="pre--content">Model: <span class="hljs-string">&quot;sequential&quot;</span><br />_________________________________________________________________<br /> Layer (<span class="hljs-built_in">type</span>)                Output Shape              Param <span class="hljs-comment">#   </span><br />=================================================================<br /> conv2d (Conv2D)             (<span class="hljs-literal">None</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>)        <span class="hljs-number">896</span>       <br />                                                                 <br /> conv2d_1 (Conv2D)           (<span class="hljs-literal">None</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>)        <span class="hljs-number">9248</span>      <br />                                                                 <br /> max_pooling2d (MaxPooling2D  (<span class="hljs-literal">None</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">32</span>)       <span class="hljs-number">0</span>         <br /> )                                                               <br />                                                                 <br /> conv2d_2 (Conv2D)           (<span class="hljs-literal">None</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">64</span>)        <span class="hljs-number">18496</span>     <br />                                                                 <br /> conv2d_3 (Conv2D)           (<span class="hljs-literal">None</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">64</span>)        <span class="hljs-number">36928</span>     <br />                                                                 <br /> max_pooling2d_1 (MaxPooling  (<span class="hljs-literal">None</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">64</span>)         <span class="hljs-number">0</span>         <br /> 2D)                                                             <br />                                                                 <br /> conv2d_4 (Conv2D)           (<span class="hljs-literal">None</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">128</span>)         <span class="hljs-number">73856</span>     <br />                                                                 <br /> conv2d_5 (Conv2D)           (<span class="hljs-literal">None</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">128</span>)         <span class="hljs-number">147584</span>    <br />                                                                 <br /> max_pooling2d_2 (MaxPooling  (<span class="hljs-literal">None</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">128</span>)        <span class="hljs-number">0</span>         <br /> 2D)                                                             <br />                                                                 <br /> flatten (Flatten)           (<span class="hljs-literal">None</span>, <span class="hljs-number">2048</span>)              <span class="hljs-number">0</span>         <br />                                                                 <br /> dense (Dense)               (<span class="hljs-literal">None</span>, <span class="hljs-number">128</span>)               <span class="hljs-number">262272</span>    <br />                                                                 <br /> dense_1 (Dense)             (<span class="hljs-literal">None</span>, <span class="hljs-number">10</span>)                <span class="hljs-number">1290</span>      <br />                                                                 <br />=================================================================<br />Total params: <span class="hljs-number">550</span>,<span class="hljs-number">570</span><br />Trainable params: <span class="hljs-number">550</span>,<span class="hljs-number">570</span><br />Non-trainable params: <span class="hljs-number">0</span><br />=================================================================</span></pre><p name="03c0" id="03c0" class="graf graf--p graf-after--pre">This will create a model with the following layers:</p><ul class="postList"><li name="f00c" id="f00c" class="graf graf--li graf-after--p">Input layer: 32x32x3 images</li><li name="02e6" id="02e6" class="graf graf--li graf-after--li">Convolutional layer with 32 filters, 3x3 kernel size, and ReLU activation</li><li name="f126" id="f126" class="graf graf--li graf-after--li">Convolutional layer with 32 filters, 3x3 kernel size, and ReLU activation</li><li name="e2e6" id="e2e6" class="graf graf--li graf-after--li">Max pooling layer with 2x2 pool size</li><li name="e488" id="e488" class="graf graf--li graf-after--li">Convolutional layer with 64 filters, 3x3 kernel size, and ReLU activation</li><li name="efdc" id="efdc" class="graf graf--li graf-after--li">Convolutional layer with 64 filters, 3x3 kernel size, and ReLU activation</li><li name="586e" id="586e" class="graf graf--li graf-after--li graf--trailing">Max pooling layer with 2x2 pool size</li></ul></div></div></section><section name="bf6e" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><blockquote name="8ea5" id="8ea5" class="graf graf--pullquote graf--leading">Training the Model</blockquote><p name="3855" id="3855" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--pullquote"><span class="graf-dropCap">A</span>fter building the model, the next step is to compile and train it using the training data. We will use the <code class="markup--code markup--p-code">adam</code> optimizer and <code class="markup--code markup--p-code">categorical_crossentropy</code> as the loss function.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="1df4" id="1df4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">&#x27;adam&#x27;</span>, loss=<span class="hljs-string">&#x27;categorical_crossentropy&#x27;</span>, metrics=[<span class="hljs-string">&#x27;accuracy&#x27;</span>])<br /><br />history = model.fit(x_train, y_train, epochs=<span class="hljs-number">10</span>, batch_size=<span class="hljs-number">32</span>, validation_data=(x_test, y_test))</span></pre><p name="a3f8" id="a3f8" class="graf graf--p graf-after--pre">This will train the model for 10 epochs with a batch size of 32. The <code class="markup--code markup--p-code">validation_data</code> parameter specifies the test data to evaluate the model after each epoch.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="e988" id="e988" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">2023-03-18 22:29:04.900753:</span> <span class="hljs-string">W</span> <span class="hljs-string">tensorflow/tsl/framework/cpu_allocator_impl.cc:82]</span> <span class="hljs-string">Allocation</span> <span class="hljs-string">of</span> <span class="hljs-number">614400000</span> <span class="hljs-string">exceeds</span> <span class="hljs-number">10</span><span class="hljs-string">%</span> <span class="hljs-string">of</span> <span class="hljs-string">free</span> <span class="hljs-string">system</span> <span class="hljs-string">memory.</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">1</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">ETA: 0s - loss: 1.4844 - accuracy:</span> <span class="hljs-number">0.4554</span><br /><span class="hljs-attr">2023-03-18 22:35:35.462951:</span> <span class="hljs-string">W</span> <span class="hljs-string">tensorflow/tsl/framework/cpu_allocator_impl.cc:82]</span> <span class="hljs-string">Allocation</span> <span class="hljs-string">of</span> <span class="hljs-number">122880000</span> <span class="hljs-string">exceeds</span> <span class="hljs-number">10</span><span class="hljs-string">%</span> <span class="hljs-string">of</span> <span class="hljs-string">free</span> <span class="hljs-string">system</span> <span class="hljs-string">memory.</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">393s 248ms/step - loss: 1.4844 - accuracy: 0.4554 - val_loss: 1.1929 - val_accuracy:</span> <span class="hljs-number">0.5733</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">2</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">337s 216ms/step - loss: 0.9673 - accuracy: 0.6580 - val_loss: 0.8762 - val_accuracy:</span> <span class="hljs-number">0.6965</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">3</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">396s 253ms/step - loss: 0.7628 - accuracy: 0.7339 - val_loss: 0.7434 - val_accuracy:</span> <span class="hljs-number">0.7449</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">4</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">363s 232ms/step - loss: 0.6351 - accuracy: 0.7761 - val_loss: 0.7235 - val_accuracy:</span> <span class="hljs-number">0.7528</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">5</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">372s 238ms/step - loss: 0.5380 - accuracy: 0.8120 - val_loss: 0.6988 - val_accuracy:</span> <span class="hljs-number">0.7647</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">6</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">401s 256ms/step - loss: 0.4544 - accuracy: 0.8406 - val_loss: 0.7253 - val_accuracy:</span> <span class="hljs-number">0.7553</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">7</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">434s 278ms/step - loss: 0.3817 - accuracy: 0.8647 - val_loss: 0.8057 - val_accuracy:</span> <span class="hljs-number">0.7567</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">8</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">858s 549ms/step - loss: 0.3285 - accuracy: 0.8828 - val_loss: 0.7970 - val_accuracy:</span> <span class="hljs-number">0.7573</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">9</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">801s 513ms/step - loss: 0.2752 - accuracy: 0.9019 - val_loss: 0.8235 - val_accuracy:</span> <span class="hljs-number">0.7606</span><br /><span class="hljs-string">Epoch</span> <span class="hljs-number">10</span><span class="hljs-string">/10</span><br /><span class="hljs-number">1563</span><span class="hljs-string">/1563</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-attr">412s 264ms/step - loss: 0.2453 - accuracy: 0.9118 - val_loss: 0.9679 - val_accuracy:</span> <span class="hljs-number">0.7579</span></span></pre><p name="b32d" id="b32d" class="graf graf--p graf-after--pre">We can plot the training and validation accuracy and loss using the <code class="markup--code markup--p-code">matplotlib</code> library.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="d92b" id="d92b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><br />plt.plot(history.history[<span class="hljs-string">&#x27;accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;accuracy&#x27;</span>)<br />plt.plot(history.history[<span class="hljs-string">&#x27;val_accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;val_accuracy&#x27;</span>)<br />plt.xlabel(<span class="hljs-string">&#x27;Epoch&#x27;</span>)<br />plt.ylabel(<span class="hljs-string">&#x27;Accuracy&#x27;</span>)<br />plt.legend()<br />plt.show()<br /><br />plt.plot(history.history[<span class="hljs-string">&#x27;loss&#x27;</span>], label=<span class="hljs-string">&#x27;loss&#x27;</span>)<br />plt.plot(history.history[<span class="hljs-string">&#x27;val_loss&#x27;</span>], label=<span class="hljs-string">&#x27;val_loss&#x27;</span>)<br />plt.xlabel(<span class="hljs-string">&#x27;Epoch&#x27;</span>)<br />plt.ylabel(<span class="hljs-string">&#x27;Loss&#x27;</span>)<br />plt.legend()<br />plt.show()</span></pre><figure name="01ae" id="01ae" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*8g41oIdNYADzvSiGs_L9KA.png" data-width="567" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*8g41oIdNYADzvSiGs_L9KA.png"></figure><figure name="ed22" id="ed22" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*Xy3D3qRqTRq-HAuG1NW6MQ.png" data-width="567" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*Xy3D3qRqTRq-HAuG1NW6MQ.png"><figcaption class="imageCaption">Image by Author</figcaption></figure><blockquote name="0d6f" id="0d6f" class="graf graf--pullquote graf-after--figure">Making Predictions:</blockquote><p name="b61f" id="b61f" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--pullquote"><span class="graf-dropCap">O</span>nce the model is trained, we can use it to make predictions on new images. We can use the <code class="markup--code markup--p-code">predict</code> function to get the predicted probabilities for each class and then use the <code class="markup--code markup--p-code">argmax</code> function to get the predicted class.</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="python" name="e2b4" id="e2b4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br /><br />predictions = model.predict(x_test)<br />predicted_classes = np.argmax(predictions, axis=<span class="hljs-number">1</span>)</span></pre><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="yaml" name="13c3" id="13c3" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-attr">2023-03-18 23:53:04.689402:</span> <span class="hljs-string">W</span> <span class="hljs-string">tensorflow/tsl/framework/cpu_allocator_impl.cc:82]</span> <span class="hljs-string">Allocation</span> <span class="hljs-string">of</span> <span class="hljs-number">122880000</span> <span class="hljs-string">exceeds</span> <span class="hljs-number">10</span><span class="hljs-string">%</span> <span class="hljs-string">of</span> <span class="hljs-string">free</span> <span class="hljs-string">system</span> <span class="hljs-string">memory.</span><br /><span class="hljs-number">313</span><span class="hljs-string">/313</span> [<span class="hljs-string">==============================</span>] <span class="hljs-bullet">-</span> <span class="hljs-string">21s</span> <span class="hljs-string">64ms/step</span></span></pre><p name="d613" id="d613" class="graf graf--p graf-after--pre">We can then compare the predicted classes with the true labels to evaluate the model’s performance.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="f53c" id="f53c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score<br /><br />accuracy = accuracy_score(np.argmax(y_test, axis=<span class="hljs-number">1</span>), predicted_classes)<br /><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Test accuracy:&#x27;</span>, accuracy)</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="6196" id="6196" class="graf graf--pre graf-after--pre graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-attr">Test accuracy:</span> <span class="hljs-number">0.7579</span></span></pre></div></div></section><section name="27ad" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><blockquote name="9e03" id="9e03" class="graf graf--pullquote graf--leading">Conclusion:</blockquote><p name="f1b9" id="f1b9" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--pullquote graf--trailing"><span class="graf-dropCap">T</span>his article discussed the basics of image classification and how to implement it using Python, TensorFlow, and Keras libraries. We built a CNN model using the CIFAR-10 dataset and trained it to classify images into 10 classes. We also evaluated the model’s performance on a separate test dataset and visualized its training history using the <code class="markup--code markup--p-code">matplotlib</code> library. Image classification is a powerful tool in computer vision and has many practical applications in industry and academia.</p></div></div></section><section name="8216" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><blockquote name="fbc4" id="fbc4" class="graf graf--pullquote graf--leading">References:</blockquote><ol class="postList"><li name="a635" id="a635" class="graf graf--li graf--startsWithDoubleQuote graf-after--pullquote">“Image Classification using Convolutional Neural Networks in Keras, Analytics Vidhya,”<a href="https://www.analyticsvidhya.com/blog/2020/10/create-image-classification-model-python-keras/" data-href="https://www.analyticsvidhya.com/blog/2020/10/create-image-classification-model-python-keras/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.analyticsvidhya.com/blog/2020/10/create-image-classification-model-python-keras/</a></li><li name="f1db" id="f1db" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“Convolutional Neural Network,” <a href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" data-href="https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://towardsdatascience.com/covolutional-neural-network-cb0883dd6529</a></li><li name="f22f" id="f22f" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“CIFAR-10 — Object Recognition in Images”, <a href="https://www.cs.toronto.edu/~kriz/cifar.html" data-href="https://www.cs.toronto.edu/~kriz/cifar.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.cs.toronto.edu/~kriz/cifar.html</a></li><li name="efa8" id="efa8" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“TensorFlow,” <a href="https://www.tensorflow.org/" data-href="https://www.tensorflow.org/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.tensorflow.org/</a></li><li name="2fc0" id="2fc0" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“Keras”, <a href="https://keras.io/" data-href="https://keras.io/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://keras.io/</a></li><li name="13c6" id="13c6" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“Matplotlib”, <a href="https://matplotlib.org/" data-href="https://matplotlib.org/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://matplotlib.org/</a></li><li name="b569" id="b569" class="graf graf--li graf--startsWithDoubleQuote graf-after--li graf--trailing">“Python Programming Language,” <a href="https://www.python.org/" data-href="https://www.python.org/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.python.org/</a></li></ol></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@the_daft_introvert" class="p-author h-card">Vishal Sharma</a> on <a href="https://medium.com/p/a25d9462bc25"><time class="dt-published" datetime="2023-03-18T18:31:04.321Z">March 18, 2023</time></a>.</p><p><a href="https://medium.com/@the_daft_introvert/image-classification-basics-with-python-and-tensorflow-building-a-cnn-model-with-cifar-10-a25d9462bc25" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 2, 2023.</p></footer></article></body></html>