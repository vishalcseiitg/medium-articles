<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>“Prime Time Battle: Comparing AKS and Rabin-Miller Primality Tests”</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">“Prime Time Battle: Comparing AKS and Rabin-Miller Primality Tests”</h1>
</header>
<section data-field="subtitle" class="p-summary">
In the world of cryptography, primality testing is a crucial problem. It involves determining whether a given number is prime or composite…
</section>
<section data-field="body" class="e-content">
<section name="28d9" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3526" id="3526" class="graf graf--h3 graf--startsWithDoubleQuote graf--leading graf--title">“Prime Time Battle: Comparing AKS and Rabin-Miller Primality Tests”</h3><p name="5273" id="5273" class="graf graf--p graf-after--h3">In the world of cryptography, primality testing is a crucial problem. It involves determining whether a given number is prime or composite. While this may seem like a simple task, it has stumped mathematicians and computer scientists for decades.</p><p name="4b62" id="4b62" class="graf graf--p graf-after--p">That all changed with the publication of “<a href="https://www.cse.iitk.ac.in/users/manindra/algebra/primality_v6.pdf" data-href="https://www.cse.iitk.ac.in/users/manindra/algebra/primality_v6.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Primes is in P</a>” by Nitin Saxena. This paper presents a breakthrough result: a new algorithm that can solve the problem of primality testing in polynomial time. This result is significant because it solves a long-standing open problem and has important implications for cryptography. In the rest of this article, we will explore the details of this paper and what it means for the field of computer science and mathematics.</p><p name="248a" id="248a" class="graf graf--p graf-after--p">Primality testing is an essential mathematical problem with wide-ranging applications, from cryptography and computer security to number theory and combinatorics. The problem of determining whether a given integer is prime or composite has been studied for centuries. With the advent of modern computing, new and efficient algorithms have been developed to solve this problem. The importance of primality testing lies in its application in various real-world scenarios where prime numbers are essential. For example, prime numbers are used to generate secure cryptographic keys, to check the integrity of data, and to compress data in digital communication. Primality testing is also essential for number theorists, who rely on prime numbers to study the distribution of primes and solve other mathematical problems. Therefore, the development of efficient primality testing algorithms is critical for various fields of study and applications.</p><p name="053f" id="053f" class="graf graf--p graf-after--p">The AKS (Agrawal-Kayal-Saxena) primality test and the Rabin-Miller primality test are two algorithms used for primality testing. The AKS test was developed in 2002 by three Indian mathematicians, while the Rabin-Miller test was developed in 1980 by Michael O. Rabin. The AKS test is a deterministic algorithm, meaning it always returns a definite answer for whether a given number is prime or not. The Rabin-Miller test, on the other hand, is a probabilistic algorithm, meaning it can make a mistake with a very small probability. However, it is much faster than the AKS test for large numbers. In this article, we will compare and contrast these two algorithms for primality testing.</p><p name="f650" id="f650" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Here is the pseudo-code for the AKS primality test:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="1cd6" id="1cd6" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-symbol">Input:</span> a positive <span class="hljs-type">integer</span> n<br /><br /><span class="hljs-keyword">if</span> n = <span class="hljs-number">2</span> <span class="hljs-built_in">or</span> n = <span class="hljs-number">3</span>, <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br /><br /><span class="hljs-keyword">if</span> n <span class="hljs-built_in">is</span> even <span class="hljs-built_in">or</span> n &lt; <span class="hljs-number">2</span>, <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br />Find the smallest r such that ord_r(n) &gt; log2(n)^<span class="hljs-number">2</span><br /><br /><span class="hljs-keyword">If</span> <span class="hljs-number">1</span> &lt; gcd(a,n) &lt; n <span class="hljs-keyword">for</span> some a &lt;= r, <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br /><span class="hljs-keyword">If</span> n &lt;= r, <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br /><br /><span class="hljs-keyword">For</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> floor(sqrt(totient(r)) * log2(n)) <span class="hljs-keyword">do</span> the following:<br /><br />a. <span class="hljs-keyword">If</span> (x + a)^n <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> congruent <span class="hljs-keyword">to</span> x^n + a (<span class="hljs-built_in">mod</span> x^r - <span class="hljs-number">1</span>, n), <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br /><span class="hljs-keyword">Return</span> <span class="hljs-literal">True</span><br /><span class="hljs-symbol">Note:</span> ord_r(n) represents the multiplicative <span class="hljs-keyword">order</span> <span class="hljs-keyword">of</span> n modulo r.</span></pre><ol class="postList"><li name="c6e9" id="c6e9" class="graf graf--li graf-after--pre">Define the function <code class="markup--code markup--li-code">aks_is_prime</code> that takes an integer <code class="markup--code markup--li-code">n</code> as input.</li><li name="9c35" id="9c35" class="graf graf--li graf-after--li">Check if <code class="markup--code markup--li-code">n</code> is equal to 2 or 3. If yes, return <code class="markup--code markup--li-code">True</code>.</li><li name="3b05" id="3b05" class="graf graf--li graf-after--li">Check if <code class="markup--code markup--li-code">n</code> is less than 2 or even. If yes, return <code class="markup--code markup--li-code">False</code>.</li><li name="5c55" id="5c55" class="graf graf--li graf-after--li">Set the variable <code class="markup--code markup--li-code">r</code> to 2.</li><li name="e41b" id="e41b" class="graf graf--li graf-after--li">Calculate the bit length of <code class="markup--code markup--li-code">n</code> and assign it to <code class="markup--code markup--li-code">logn</code>.</li><li name="8c3a" id="8c3a" class="graf graf--li graf-after--li">Loop while <code class="markup--code markup--li-code">pow(n % r, n-1, n) == 1</code> and <code class="markup--code markup--li-code">pow(n % r, (n-1)//2, n) == 1</code> and <code class="markup--code markup--li-code">r &lt;= logn**2</code>.</li></ol><ul class="postList"><li name="a537" id="a537" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">pow(a, b, m)</code> calculates <code class="markup--code markup--li-code">(a^b) mod m</code>, so <code class="markup--code markup--li-code">pow(n % r, n-1, n)</code> calculates <code class="markup--code markup--li-code">(n mod r)^(n-1) mod n</code>.</li><li name="1f93" id="1f93" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">//</code> is integer division, so <code class="markup--code markup--li-code">(n-1)//2</code> calculates floor division of <code class="markup--code markup--li-code">n-1</code> by <code class="markup--code markup--li-code">2</code>.</li></ul><ol class="postList"><li name="5f4c" id="5f4c" class="graf graf--li graf-after--li">If <code class="markup--code markup--li-code">r</code> is greater than <code class="markup--code markup--li-code">logn**2</code>, return <code class="markup--code markup--li-code">False</code>.</li><li name="0280" id="0280" class="graf graf--li graf-after--li">Set the variable <code class="markup--code markup--li-code">k</code> to 1.</li><li name="4239" id="4239" class="graf graf--li graf-after--li">Loop while <code class="markup--code markup--li-code">k &lt;= logn**6</code>.</li><li name="a2af" id="a2af" class="graf graf--li graf-after--li">Choose a random integer <code class="markup--code markup--li-code">a</code> between 1 and <code class="markup--code markup--li-code">n-1</code>.</li><li name="7f14" id="7f14" class="graf graf--li graf-after--li">If the greatest common divisor of <code class="markup--code markup--li-code">a</code> and <code class="markup--code markup--li-code">n</code> is greater than 1, return <code class="markup--code markup--li-code">False</code>.</li><li name="f52c" id="f52c" class="graf graf--li graf-after--li">Initialize list <code class="markup--code markup--li-code">f</code> with length <code class="markup--code markup--li-code">r</code> and set each element to <code class="markup--code markup--li-code">(n mod r)^i</code> for <code class="markup--code markup--li-code">i</code> in range <code class="markup--code markup--li-code">r</code>.</li><li name="5a50" id="5a50" class="graf graf--li graf-after--li">Prepend <code class="markup--code markup--li-code">f</code> with a 1 and set the remaining elements to 0.</li><li name="e5ed" id="e5ed" class="graf graf--li graf-after--li">Initialize list <code class="markup--code markup--li-code">g</code> with length <code class="markup--code markup--li-code">r</code> and set each element to <code class="markup--code markup--li-code">(a mod n)^i</code> for <code class="markup--code markup--li-code">i</code> in range <code class="markup--code markup--li-code">r</code>.</li><li name="cd87" id="cd87" class="graf graf--li graf-after--li">Subtract each element of <code class="markup--code markup--li-code">f</code> from the corresponding element of <code class="markup--code markup--li-code">g</code> and take the result modulo <code class="markup--code markup--li-code">n</code>. Assign the result to <code class="markup--code markup--li-code">g</code>.</li><li name="0656" id="0656" class="graf graf--li graf-after--li">Append <code class="markup--code markup--li-code">g</code> with <code class="markup--code markup--li-code">2*r-1</code> 0&#39;s and assign the result to <code class="markup--code markup--li-code">g</code>.</li><li name="34a2" id="34a2" class="graf graf--li graf-after--li">Initialize list <code class="markup--code markup--li-code">h</code> with <code class="markup--code markup--li-code">2*r-1</code> 0&#39;s and set the first element to 1.</li><li name="eadf" id="eadf" class="graf graf--li graf-after--li">Loop for <code class="markup--code markup--li-code">i</code> in the range <code class="markup--code markup--li-code">n.bit_length()</code>.</li><li name="a506" id="a506" class="graf graf--li graf-after--li">If the <code class="markup--code markup--li-code">i</code>-th bit of <code class="markup--code markup--li-code">k</code> is 1, multiply each element of <code class="markup--code markup--li-code">h</code> by the corresponding element of <code class="markup--code markup--li-code">g</code> and add the result to the previous element of <code class="markup--code markup--li-code">h</code> modulo <code class="markup--code markup--li-code">n</code>. Assign the result to <code class="markup--code markup--li-code">h</code>.</li><li name="5bba" id="5bba" class="graf graf--li graf-after--li">If the <code class="markup--code markup--li-code">i</code>-th bit of <code class="markup--code markup--li-code">k</code> is 0, square each element of <code class="markup--code markup--li-code">h</code> and take the result modulo <code class="markup--code markup--li-code">n</code>. Assign the result to <code class="markup--code markup--li-code">h</code>.</li><li name="e89e" id="e89e" class="graf graf--li graf-after--li">If <code class="markup--code markup--li-code">h[r-1]</code> is not equal to 0, return <code class="markup--code markup--li-code">True</code>.</li><li name="b556" id="b556" class="graf graf--li graf-after--li">Increment <code class="markup--code markup--li-code">k</code> by 1.</li><li name="f1da" id="f1da" class="graf graf--li graf-after--li">If the loop on line 9 completes without returning <code class="markup--code markup--li-code">True</code>, return <code class="markup--code markup--li-code">False</code>.</li></ol><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="59f2" id="59f2" class="graf graf--pre graf-after--li graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br /><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">aks_is_prime</span>(<span class="hljs-params">n</span>):<br />    <span class="hljs-keyword">if</span> n == <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> n == <span class="hljs-number">3</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br />    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br />    <span class="hljs-comment"># Find the smallest r such that ord_r(n) &gt; log2(n)^2</span><br />    r = <span class="hljs-number">2</span><br />    logn = n.bit_length()<br />    <span class="hljs-keyword">while</span> <span class="hljs-built_in">pow</span>(n % r, n-<span class="hljs-number">1</span>, n) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">pow</span>(n % r, (n-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, n) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> r &lt;= logn**<span class="hljs-number">2</span>:<br />        r += <span class="hljs-number">1</span><br /><br />    <span class="hljs-keyword">if</span> r &gt; logn**<span class="hljs-number">2</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br />    <span class="hljs-comment"># Find the smallest k such that (x + a)^n = x^n + a (mod x^r - 1, n)</span><br />    k = <span class="hljs-number">1</span><br />    <span class="hljs-keyword">while</span> k &lt;= logn**<span class="hljs-number">6</span>:<br />        a = random.randint(<span class="hljs-number">1</span>, n-<span class="hljs-number">1</span>)<br />        <span class="hljs-keyword">if</span> gcd(a, n) &gt; <span class="hljs-number">1</span>:<br />            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br />        f = [(n % r)**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r)]<br />        f = [<span class="hljs-number">1</span>] + [<span class="hljs-number">0</span>]*(r-<span class="hljs-number">1</span>) + f<br />        g = [(a % n)**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r)]<br />        g = [g[i] - f[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r)]<br />        g = [g[i] % n <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r)]<br />        g = g + [<span class="hljs-number">0</span>]*(<span class="hljs-number">2</span>*r-<span class="hljs-number">1</span>)<br />        h = [<span class="hljs-number">0</span>]*(<span class="hljs-number">2</span>*r-<span class="hljs-number">1</span>)<br />        h[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br />        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n.bit_length()):<br />            <span class="hljs-keyword">if</span> (<span class="hljs-number">1</span> &lt;&lt; i) &amp; k:<br />                h = [(h[j] * g[i] + h[j-<span class="hljs-number">1</span>]) % n <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>*r-<span class="hljs-number">1</span>)]<br />            <span class="hljs-keyword">else</span>:<br />                h = [(h[j] * h[j-<span class="hljs-number">1</span>]) % n <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>*r-<span class="hljs-number">1</span>)]<br />        <span class="hljs-keyword">if</span> h[r-<span class="hljs-number">1</span>] != <span class="hljs-number">0</span>:<br />            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br />        k += <span class="hljs-number">1</span><br /><br />    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">2</span>))   <span class="hljs-comment"># True</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">3</span>))   <span class="hljs-comment"># True</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">5</span>))   <span class="hljs-comment"># True</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">7</span>))   <span class="hljs-comment"># True</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">11</span>))  <span class="hljs-comment"># True</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">15</span>))  <span class="hljs-comment"># False</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">21</span>))  <span class="hljs-comment"># False</span><br /><span class="hljs-built_in">print</span>(aks_is_prime(<span class="hljs-number">25</span>))  <span class="hljs-comment"># False</span></span></pre></div></div></section><section name="7216" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="2bbb" id="2bbb" class="graf graf--p graf--leading">In the Miller-Rabin primality test, the algorithm computes a value <code class="markup--code markup--p-code">x</code> using the formula <code class="markup--code markup--p-code">(x + a)^d mod n</code>, where <code class="markup--code markup--p-code">a</code> is a random integer between 2 and <code class="markup--code markup--p-code">n-2</code>, and <code class="markup--code markup--p-code">d</code> is the largest power of 2 that divides <code class="markup--code markup--p-code">n-1</code>. This formula is based on the observation that, if <code class="markup--code markup--p-code">n</code> is prime, then for any integer <code class="markup--code markup--p-code">a</code> not divisible by <code class="markup--code markup--p-code">n</code>, we have:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="scss" name="9dfb" id="9dfb" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">(x + a)^(n-<span class="hljs-number">1</span>) ≡ <span class="hljs-number">1</span> (mod n)</span></pre><p name="c567" id="c567" class="graf graf--p graf-after--pre">This is known as Fermat’s Little Theorem. If we assume that <code class="markup--code markup--p-code">n</code> is prime and set <code class="markup--code markup--p-code">d = n-1</code>, then we can write <code class="markup--code markup--p-code">(x + a)^(n-1)</code> as:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="76ef" id="76ef" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">(x + a)^(n-1) = (x + a)^(2^s * d<span class="hljs-string">&#x27;) = [(x + a)^d&#x27;</span>]^(2^s)</span></pre><p name="6eec" id="6eec" class="graf graf--p graf-after--pre">where <code class="markup--code markup--p-code">s</code> is the largest integer such that <code class="markup--code markup--p-code">2^s</code> divides <code class="markup--code markup--p-code">n-1</code>, and <code class="markup--code markup--p-code">d&#39; = (n-1) / 2^s</code>. We can then use repeated squaring to compute <code class="markup--code markup--p-code">(x + a)^(n-1)</code> efficiently.</p><p name="0d96" id="0d96" class="graf graf--p graf-after--p">However, we can’t use this directly to test primality, since there are composite numbers <code class="markup--code markup--p-code">n</code> that satisfy Fermat&#39;s Little Theorem for all <code class="markup--code markup--p-code">a</code> not divisible by <code class="markup--code markup--p-code">n</code>. The Miller-Rabin primality test works around this problem by choosing a random value of <code class="markup--code markup--p-code">a</code> and computing <code class="markup--code markup--p-code">(x + a)^d mod n</code>, where <code class="markup--code markup--p-code">d</code> is the largest power of 2 that divides <code class="markup--code markup--p-code">n-1</code>. If <code class="markup--code markup--p-code">n</code> is composite, there is a high probability that the resulting value of <code class="markup--code markup--p-code">x</code> will not be congruent to 1 mod <code class="markup--code markup--p-code">n</code> or <code class="markup--code markup--p-code">n-1</code>.</p><p name="cc8b" id="cc8b" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Miller-Rabin primality test</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="dfe1" id="dfe1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> random<br /><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin_is_prime</span>(<span class="hljs-params">n, k=<span class="hljs-number">10</span></span>):<br />    <span class="hljs-keyword">if</span> n &lt;= <span class="hljs-number">1</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br />    <span class="hljs-keyword">if</span> n == <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> n == <span class="hljs-number">3</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br />    <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br /><br />    <span class="hljs-comment"># Write n-1 as 2^r * d</span><br />    r = <span class="hljs-number">0</span><br />    d = n - <span class="hljs-number">1</span><br />    <span class="hljs-keyword">while</span> d % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br />        r += <span class="hljs-number">1</span><br />        d //= <span class="hljs-number">2</span><br /><br />    <span class="hljs-comment"># Repeat k times</span><br />    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br />        a = random.randint(<span class="hljs-number">2</span>, n-<span class="hljs-number">2</span>)<br />        x = <span class="hljs-built_in">pow</span>(a, d, n)<br />        <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x == n-<span class="hljs-number">1</span>:<br />            <span class="hljs-keyword">continue</span><br />        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r-<span class="hljs-number">1</span>):<br />            x = <span class="hljs-built_in">pow</span>(x, <span class="hljs-number">2</span>, n)<br />            <span class="hljs-keyword">if</span> x == n-<span class="hljs-number">1</span>:<br />                <span class="hljs-keyword">break</span><br />        <span class="hljs-keyword">else</span>:<br />            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br />    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></span></pre><p name="6fa9" id="6fa9" class="graf graf--p graf-after--pre">This implementation takes in an integer <code class="markup--code markup--p-code">n</code> and an optional parameter <code class="markup--code markup--p-code">k</code> that determines how many iterations to perform. The default value of <code class="markup--code markup--p-code">k</code> is 10.</p><p name="e562" id="e562" class="graf graf--p graf-after--p">The function first checks some base cases: if <code class="markup--code markup--p-code">n</code> is less than or equal to 1, or if <code class="markup--code markup--p-code">n</code> is 2 or 3, it returns <code class="markup--code markup--p-code">True</code>. If <code class="markup--code markup--p-code">n</code> is even, it returns <code class="markup--code markup--p-code">False</code>.</p><p name="e248" id="e248" class="graf graf--p graf-after--p">Next, it writes <code class="markup--code markup--p-code">n-1</code> as <code class="markup--code markup--p-code">2^r * d</code>, where <code class="markup--code markup--p-code">d</code> is an odd integer. This is an important step for the algorithm.</p><p name="309a" id="309a" class="graf graf--p graf-after--p">The function then performs the Miller-Rabin test <code class="markup--code markup--p-code">k</code> times. In each iteration, it chooses a random integer <code class="markup--code markup--p-code">a</code> between 2 and <code class="markup--code markup--p-code">n-2</code>, and computes <code class="markup--code markup--p-code">x = a^d mod n</code>. If <code class="markup--code markup--p-code">x</code> is 1 or <code class="markup--code markup--p-code">n-1</code>, it continues to the next iteration. Otherwise, it repeatedly squares <code class="markup--code markup--p-code">x</code> and checks whether it is equal to <code class="markup--code markup--p-code">n-1</code>. If it is not, the function returns <code class="markup--code markup--p-code">False</code>, indicating that <code class="markup--code markup--p-code">n</code> is composite. If all iterations pass, the function returns <code class="markup--code markup--p-code">True</code>, indicating that <code class="markup--code markup--p-code">n</code> is likely prime.</p><p name="f0ef" id="f0ef" class="graf graf--p graf-after--p">The Rabin-Miller primality test is a probabilistic algorithm that provides a fast and reliable way to test for primality. The value of <code class="markup--code markup--p-code">k</code> determines the probability of error, with higher values of <code class="markup--code markup--p-code">k</code> providing greater accuracy.</p><figure name="a3a6" id="a3a6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aV6ct9bZ-GIB8cImTgZVTg.png" data-width="874" data-height="475" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*aV6ct9bZ-GIB8cImTgZVTg.png"><figcaption class="imageCaption">Miller-Rabin vs. Traditional Method</figcaption></figure><p name="c6c7" id="c6c7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Comparison of Miller-Rabin and AKS Primality Test</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="0aad" id="0aad" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> time<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br /><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> isprime<br /><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> isprime <span class="hljs-keyword">as</span> isprime_mr<br /><br /><span class="hljs-comment"># Measure time taken by Miller-Rabin primality test</span><br />start = time.time()<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1000000</span>):<br />    isprime_mr(i)<br />mr_time = time.time() - start<br /><br /><span class="hljs-comment"># Measure time taken by AKS primality test</span><br />start = time.time()<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1000000</span>):<br />    isprime(i)<br />aks_time = time.time() - start<br /><br /><span class="hljs-comment"># Create bar plot</span><br />bar_width = <span class="hljs-number">0.4</span><br />fig, ax = plt.subplots()<br />mr_bar = ax.bar(<span class="hljs-string">&quot;Miller-Rabin&quot;</span>, mr_time, bar_width, color=<span class="hljs-string">&quot;#0072B2&quot;</span>)<br />aks_bar = ax.bar(<span class="hljs-string">&quot;AKS&quot;</span>, aks_time, bar_width, color=<span class="hljs-string">&quot;#009E73&quot;</span>)<br /><br /><span class="hljs-comment"># Add labels and title</span><br />ax.set_ylabel(<span class="hljs-string">&quot;Time (s)&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Comparison of Miller-Rabin and AKS primality tests&quot;</span>)<br />ax.set_xticks([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<br />ax.set_xticklabels([<span class="hljs-string">&quot;Miller-Rabin&quot;</span>, <span class="hljs-string">&quot;AKS&quot;</span>])<br />ax.yaxis.grid(<span class="hljs-literal">True</span>)<br /><br /><span class="hljs-comment"># Add values to bars</span><br /><span class="hljs-keyword">def</span> <span class="hljs-title function_">autolabel</span>(<span class="hljs-params">rects</span>):<br />    <span class="hljs-keyword">for</span> rect <span class="hljs-keyword">in</span> rects:<br />        height = rect.get_height()<br />        ax.annotate(<span class="hljs-string">f&quot;<span class="hljs-subst">{height:<span class="hljs-number">.3</span>f}</span>&quot;</span>,<br />                    xy=(rect.get_x() + rect.get_width() / <span class="hljs-number">2</span>, height),<br />                    xytext=(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>),<br />                    textcoords=<span class="hljs-string">&quot;offset points&quot;</span>,<br />                    ha=<span class="hljs-string">&quot;center&quot;</span>, va=<span class="hljs-string">&quot;bottom&quot;</span>, fontsize=<span class="hljs-number">12</span>)<br />autolabel(mr_bar)<br />autolabel(aks_bar)<br /><br /><span class="hljs-comment"># Add a horizontal line at y=0</span><br />ax.axhline(y=<span class="hljs-number">0</span>, color=<span class="hljs-string">&quot;black&quot;</span>, linewidth=<span class="hljs-number">0.5</span>)<br /><br /><span class="hljs-comment"># Add a legend</span><br />ax.legend((mr_bar, aks_bar), (<span class="hljs-string">&quot;Miller-Rabin&quot;</span>, <span class="hljs-string">&quot;AKS&quot;</span>))<br /><br /><span class="hljs-comment"># Adjust the layout</span><br />plt.subplots_adjust(bottom=<span class="hljs-number">0.2</span>)<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-comparison.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="b9b7" id="b9b7" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*F7bT2u0UTW9xJYIagS1QNQ.png" data-width="567" data-height="390" src="https://cdn-images-1.medium.com/max/800/1*F7bT2u0UTW9xJYIagS1QNQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="2381" id="2381" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> time<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br /><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> isprime<br /><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> isprime <span class="hljs-keyword">as</span> isprime_mr<br /><br /><span class="hljs-comment"># Measure time taken by Miller-Rabin primality test</span><br />mr_times = []<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1000001</span>):<br />    start = time.time()<br />    isprime_mr(i)<br />    mr_times.append(time.time() - start)<br /><br /><span class="hljs-comment"># Measure time taken by AKS primality test</span><br />aks_times = []<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1000001</span>):<br />    start = time.time()<br />    isprime(i)<br />    aks_times.append(time.time() - start)<br /><br /><span class="hljs-comment"># Create combined plot with violin plots</span><br />fig, ax = plt.subplots(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">6</span>))<br /><br />sns.violinplot(x=[<span class="hljs-string">&quot;Miller-Rabin&quot;</span>]*<span class="hljs-built_in">len</span>(mr_times)+[<span class="hljs-string">&quot;AKS&quot;</span>]*<span class="hljs-built_in">len</span>(aks_times),<br />               y=mr_times+aks_times,<br />               palette=[<span class="hljs-string">&quot;#0072B2&quot;</span>, <span class="hljs-string">&quot;#009E73&quot;</span>])<br /><br /><span class="hljs-comment"># Set labels and title</span><br />ax.set_xlabel(<span class="hljs-string">&quot;Primality Test&quot;</span>)<br />ax.set_ylabel(<span class="hljs-string">&quot;Time (s)&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Distribution of Time Taken by Primality Tests&quot;</span>)<br /><br /><span class="hljs-comment"># Remove spines and tick marks</span><br />sns.despine(ax=ax, left=<span class="hljs-literal">True</span>)<br />ax.tick_params(left=<span class="hljs-literal">False</span>)<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-distribution.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="e2c9" id="e2c9" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*vA_dFryB1ToYFW3dAP30mA.png" data-width="735" data-height="545" src="https://cdn-images-1.medium.com/max/800/1*vA_dFryB1ToYFW3dAP30mA.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="edb1" id="edb1" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> time<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><br /><span class="hljs-comment"># Measure time taken by Miller-Rabin primality test</span><br />mr_times = []<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">10001</span>):<br />    start = time.time()<br />    isprime_mr(i)<br />    mr_times.append(time.time() - start)<br /><br /><span class="hljs-comment"># Measure time taken by AKS primality test</span><br />aks_times = []<br /><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">10001</span>):<br />    start = time.time()<br />    isprime(i)<br />    aks_times.append(time.time() - start)<br /><br /><span class="hljs-comment"># Calculate the number of operations performed by each test for each value of n</span><br />mr_ops = [i * (<span class="hljs-built_in">int</span>(i).bit_length() - <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">10001</span>)]<br />aks_ops = [<span class="hljs-built_in">int</span>(i).bit_length()**<span class="hljs-number">10</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">10001</span>)]<br /><br /><span class="hljs-comment"># Create combined plot with efficiency curves</span><br />fig, ax = plt.subplots(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">6</span>))<br /><br />ax.plot(mr_ops, mr_times, label=<span class="hljs-string">&quot;Miller-Rabin&quot;</span>, color=<span class="hljs-string">&quot;#0072B2&quot;</span>)<br />ax.plot(aks_ops, aks_times, label=<span class="hljs-string">&quot;AKS&quot;</span>, color=<span class="hljs-string">&quot;#009E73&quot;</span>)<br /><br /><span class="hljs-comment"># Set labels and title</span><br />ax.set_xlabel(<span class="hljs-string">&quot;Number of Operations&quot;</span>)<br />ax.set_ylabel(<span class="hljs-string">&quot;Time (s)&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Efficiency of Primality Tests&quot;</span>)<br /><br /><span class="hljs-comment"># Set x-axis scale to log</span><br />ax.set_xscale(<span class="hljs-string">&quot;log&quot;</span>)<br /><br /><span class="hljs-comment"># Add legend</span><br />ax.legend()<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-efficiency.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="29eb" id="29eb" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*AsS6mapwIYC2YD0iIyGLRQ.png" data-width="726" data-height="550" src="https://cdn-images-1.medium.com/max/800/1*AsS6mapwIYC2YD0iIyGLRQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="f004" id="f004" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> random<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br /><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> isprime<br /><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> isprime <span class="hljs-keyword">as</span> isprime_mr<br /><br /><span class="hljs-comment"># Define the number of random numbers to test</span><br />n = <span class="hljs-number">1000</span><br /><br /><span class="hljs-comment"># Generate a list of random numbers</span><br />numbers = [random.randint(<span class="hljs-number">10</span>**<span class="hljs-number">6</span>, <span class="hljs-number">10</span>**<span class="hljs-number">7</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br /><br /><span class="hljs-comment"># Run Miller-Rabin primality test on each number</span><br />mr_results = []<br /><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers:<br />    start = time.time()<br />    isprime_mr(num)<br />    mr_results.append(time.time() - start)<br /><br /><span class="hljs-comment"># Run AKS primality test on each number</span><br />aks_results = []<br /><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers:<br />    start = time.time()<br />    isprime(num)<br />    aks_results.append(time.time() - start)<br /><br /><span class="hljs-comment"># Create violin plot</span><br />fig, ax = plt.subplots(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))<br /><br />sns.violinplot(data=[mr_results, aks_results], palette=[<span class="hljs-string">&quot;#0C5DA5&quot;</span>, <span class="hljs-string">&quot;#FF5733&quot;</span>])<br /><br /><span class="hljs-comment"># Set labels and title</span><br />ax.set_xticklabels([<span class="hljs-string">&quot;Miller-Rabin&quot;</span>, <span class="hljs-string">&quot;AKS&quot;</span>])<br />ax.set_ylabel(<span class="hljs-string">&quot;Time (s)&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Comparison of Primality Test Speeds&quot;</span>)<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-violin.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="73da" id="73da" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*i9a_z3pKuUuv13yCb4YIOQ.png" data-width="846" data-height="680" src="https://cdn-images-1.medium.com/max/800/1*i9a_z3pKuUuv13yCb4YIOQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="845a" id="845a" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> random<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br /><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br /><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> isprime<br /><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> isprime <span class="hljs-keyword">as</span> isprime_mr<br /><br /><span class="hljs-comment"># Define the number of random numbers to test</span><br />n = <span class="hljs-number">1000</span><br /><br /><span class="hljs-comment"># Generate a list of random numbers</span><br />numbers = [random.randint(<span class="hljs-number">10</span>**<span class="hljs-number">6</span>, <span class="hljs-number">10</span>**<span class="hljs-number">7</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br /><br /><span class="hljs-comment"># Run Miller-Rabin primality test on each number</span><br />mr_results = [isprime_mr(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers]<br /><br /><span class="hljs-comment"># Run AKS primality test on each number</span><br />aks_results = [isprime(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers]<br /><br /><span class="hljs-comment"># Create contingency table</span><br />table = np.zeros((<span class="hljs-number">2</span>, <span class="hljs-number">2</span>))<br /><span class="hljs-keyword">for</span> mr, aks <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(mr_results, aks_results):<br />    table[<span class="hljs-built_in">int</span>(mr)][<span class="hljs-built_in">int</span>(aks)] += <span class="hljs-number">1</span><br /><br /><span class="hljs-comment"># Create heatmap</span><br />fig, ax = plt.subplots(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))<br /><br />sns.heatmap(table, cmap=<span class="hljs-string">&quot;YlGnBu&quot;</span>, annot=<span class="hljs-literal">True</span>, fmt=<span class="hljs-string">&quot;g&quot;</span>)<br /><br /><span class="hljs-comment"># Set labels and title</span><br />ax.set_xticklabels([<span class="hljs-string">&quot;AKS Composite&quot;</span>, <span class="hljs-string">&quot;AKS Prime&quot;</span>])<br />ax.set_yticklabels([<span class="hljs-string">&quot;Miller-Rabin Composite&quot;</span>, <span class="hljs-string">&quot;Miller-Rabin Prime&quot;</span>])<br />ax.set_xlabel(<span class="hljs-string">&quot;AKS Result&quot;</span>)<br />ax.set_ylabel(<span class="hljs-string">&quot;Miller-Rabin Result&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Comparison of Primality Test Results&quot;</span>)<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-heatmap.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="721b" id="721b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*G-v9C8_LUy-NqrXUqPvWtQ.png" data-width="789" data-height="699" src="https://cdn-images-1.medium.com/max/800/1*G-v9C8_LUy-NqrXUqPvWtQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="5bbe" id="5bbe" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> random<br /><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br /><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br /><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> isprime<br /><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> isprime <span class="hljs-keyword">as</span> isprime_mr<br /><br /><span class="hljs-comment"># Define the number of random numbers to test</span><br />n = <span class="hljs-number">1000</span><br /><br /><span class="hljs-comment"># Generate a list of random numbers</span><br />numbers = [random.randint(<span class="hljs-number">10</span>**<span class="hljs-number">6</span>, <span class="hljs-number">10</span>**<span class="hljs-number">7</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br /><br /><span class="hljs-comment"># Run Miller-Rabin primality test on each number</span><br />mr_results = [isprime_mr(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers]<br /><br /><span class="hljs-comment"># Run AKS primality test on each number</span><br />aks_results = [isprime(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers]<br /><br /><span class="hljs-comment"># Create scatter plot</span><br />fig, ax = plt.subplots(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))<br /><br />sns.scatterplot(x=mr_results, y=aks_results, hue=mr_results, palette=[<span class="hljs-string">&quot;#FF5733&quot;</span>, <span class="hljs-string">&quot;#0C5DA5&quot;</span>])<br /><br /><span class="hljs-comment"># Add diagonal line for perfect agreement</span><br />lims = [<span class="hljs-built_in">min</span>(ax.get_xlim() + ax.get_ylim()), <span class="hljs-built_in">max</span>(ax.get_xlim() + ax.get_ylim())]<br />ax.plot(lims, lims, <span class="hljs-string">&#x27;k--&#x27;</span>)<br /><br /><span class="hljs-comment"># Set labels and title</span><br />ax.set_xlabel(<span class="hljs-string">&quot;Miller-Rabin Result&quot;</span>)<br />ax.set_ylabel(<span class="hljs-string">&quot;AKS Result&quot;</span>)<br />ax.set_title(<span class="hljs-string">&quot;Comparison of Primality Test Results&quot;</span>)<br /><br /><span class="hljs-comment"># Save the figure</span><br />plt.savefig(<span class="hljs-string">&quot;primality-test-scatter.png&quot;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&quot;tight&quot;</span>)<br /><br /><span class="hljs-comment"># Display the plot</span><br />plt.show()</span></pre><figure name="80c6" id="80c6" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*i0VklogUed8zEF4PUBr9Jg.png" data-width="846" data-height="699" src="https://cdn-images-1.medium.com/max/800/1*i0VklogUed8zEF4PUBr9Jg.png"></figure><p name="04ed" id="04ed" class="graf graf--p graf-after--figure">The AKS primality and Miller-Rabin tests are popular algorithms for determining whether a given number is prime or composite. While both tests are efficient and accurate, their underlying principles and computational complexity differ.</p><p name="f989" id="f989" class="graf graf--p graf-after--p">The AKS primality test is a deterministic algorithm based on polynomial-time algorithms and can determine whether a number is prime or composite in polynomial time. It has a theoretical advantage over the probabilistic Miller-Rabin test in terms of its rigorous mathematical proof, but it may not always be the most efficient algorithm in practice.</p><p name="0781" id="0781" class="graf graf--p graf-after--p">On the other hand, the Miller-Rabin test is a probabilistic algorithm that relies on randomization and can determine the primality of a number with a high degree of certainty. While it may produce false positives, the probability of this happening can be arbitrarily small by repeating the test with different random bases.</p><p name="a563" id="a563" class="graf graf--p graf-after--p graf--trailing">Overall, the AKS primality test and the Miller-Rabin test have their advantages and disadvantages, and the choice of which algorithm to use will depend on the specific requirements of the problem. However, with the availability of these powerful algorithms, it is easier than ever to determine whether a number is prime or composite accurately.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@the_daft_introvert" class="p-author h-card">Vishal Sharma</a> on <a href="https://medium.com/p/c7a53e55088a"><time class="dt-published" datetime="2023-03-08T05:55:18.404Z">March 8, 2023</time></a>.</p><p><a href="https://medium.com/@the_daft_introvert/prime-time-battle-comparing-aks-and-rabin-miller-primality-tests-c7a53e55088a" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 2, 2023.</p></footer></article></body></html>